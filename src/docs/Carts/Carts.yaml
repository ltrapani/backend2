paths:
  /api/carts:
    post:
      summary: Create an empty cart
      tags:
        - Carts
      responses:
        "200":
          description: The cart was successfully created in the database
        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
  /api/carts/{cid}:
    get:
      summary: A single cart is obtained from its cid
      tags:
        - Carts
      parameters:
        - name: cid
          in: path
          required: true
          description: The cart id
          schema:
            $type: String
      responses:
        "200":
          description: The cart was successfully retrieved from the database
          content:
            appplication/json:
              schema:
                $ref: "#components/schemas/Cart"
        "400":
          description: Invalid cid
        "404":
          description: Cart id not found
        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
    put:
      summary: A cart is updated from its cid
      tags:
        - Carts
      parameters:
        - name: cid
          in: path
          required: true
          description: The cart id
          schema:
            $type: String
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#components/requestBodies/updateCart"
      responses:
        "200":
          description: The cart was successfully updated in the database
        "400":
          description: Invalid cid
        "404":
          description: Cart not found
        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
    delete:
      summary: All products are removed from the cart
      tags:
        - Carts
      parameters:
        - name: cid
          in: path
          required: true
          description: El id del carrito
          schema:
            $type: String
      responses:
        "200":
          description: All products successfully removed from cart
        "400":
          description: Invalid id
        "403":
          description: You don't have permissions
        "404":
          description: Cart not found
        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
  /api/carts/{cid}/purchase:
    post:
      summary: Cart purchase is made
      tags:
        - Carts
      parameters:
        - name: cid
          in: path
          required: true
          description: The cart id
          schema:
            $type: String
      responses:
        "200":
          description: Se realizo la compra del carrito exitosamente
          content:
            appplication/json:
              schema:
                $ref: "#components/schemas/Ticket"
        "400":
          description: Invalid id
        "403":
          description: You don't have permissions
        "404":
          description: Cart not found
        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
  /api/carts/{cid}/product/{pid}:
    post:
      summary: A product is added to a cart based on its cid and pid respectively
      tags:
        - Carts
      parameters:
        - name: cid
          in: path
          required: true
          description: The cart id
          schema:
            $type: String
        - name: pid
          in: path
          required: true
          description: The product id
          schema:
            $type: String
      responses:
        "200":
          description: The product was successfully added to the cart in the database
        "400":
          description: You entered an invalid id!!!
        "404":
          description: Error, cart or product not found
          content:
            appplication/json:
              schema:
                oneOf:
                  - $ref: "#components/responseBodies/addProductNotFoundCart"
                  - $ref: "#components/responseBodies/addProductNotFoundProduct"
        "403":
          description: You don't have permissions

        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
    put:
      summary: The quantity of a product in a cart is updated based on its pid and cid respectively
      tags:
        - Carts
      parameters:
        - name: cid
          in: path
          required: true
          description: The cart id
          schema:
            $type: String
        - name: pid
          in: path
          required: true
          description: The product id
          schema:
            $type: String
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#components/requestBodies/updateQuantity"
      responses:
        "200":
          description: The quantity of the product in the cart was successfully updated in the database
        "400":
          description: Error, incomplete values or invalid id
          content:
            appplication/json:
              schema:
                oneOf:
                  - $ref: "#components/responseBodies/updateQuantityIncompleteValues"
                  - $ref: "#components/responseBodies/updateQuantityInvalidId"
        "404":
          description: Error, cart or product not found
          content:
            appplication/json:
              schema:
                oneOf:
                  - $ref: "#components/responseBodies/updateQuantityCartNotFound"
                  - $ref: "#components/responseBodies/updateQuantityProductNotFound"
        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
    delete:
      summary: A product is removed from a cart based on its pid and cid respectively
      tags:
        - Carts
      parameters:
        - name: cid
          in: path
          required: true
          description: The cart id
          schema:
            $type: String
        - name: pid
          in: path
          required: true
          description: The product id
          schema:
            $type: String
      responses:
        "200":
          description: The product was removed from the cart successfully
        "400":
          description: Invalid id
        "404":
          description: Error, product or cart not found
          content:
            appplication/json:
              schema:
                oneOf:
                  - $ref: "#components/responseBodies/deleteProductCartNotFound"
                  - $ref: "#components/responseBodies/deleteProductProductNotFound"
        "500":
          description: Internal server error, generated by a faulty query or connection failure to the database
components:
  schemas:
    Cart:
      type: object
      properties:
        _id:
          type: ObjectId
          description: Mongodb autogenerated id
        products:
          type: Array
          description: Array of products
          items:
            type: object
            properties:
              product:
                type: ObjectId
                $ref: "#components/schemas/Product"
              quantity:
                type: Number
                description: Product quantity
      example:
        _id: 6473e40e74e7a665ba1cc045
        products:
          [
            {
              "_id": "6418385b16ffae70c2891a42",
              "title": "Awesome Steel Towels",
              "price": "498",
              "description": "Ergonomic executive chair upholstered in bonded black leather and PVC padded seat and back for all-day comfort and support",
              "code": "a104",
              "status": "true",
              "stock": "61",
              "thumbnail":
                [
                  "https://api.lorem.space/image/watch?w=640&h=480&r=2999",
                  "https://api.lorem.space/image/watch?w=640&h=480&r=5912",
                  "https://api.lorem.space/image/watch?w=640&h=480&r=7759",
                ],
              "category": "Electronics",
              "owner": "admin",
              "quantity": "1",
            },
          ]
        total: 498
    Product:
      type: object
      properties:
        _id:
          type: ObjectId
          description: Mongodb autogenerated id
        title:
          type: String
          description: Product name
        description:
          type: String
          description: Product description
        code:
          type: String
          description: Product code
        price:
          type: Number
          description: Product price
        status:
          type: String
          description: Product state
        stock:
          type: String
          description: Available stock of the product
        category:
          type: String
          description: Product category
        thumbnail:
          type: Array
          description: Product Image URLs
        owner:
          type: String
          description: Email of the user who created the product
      example:
        _id: 6418385b16ffae70c2891a49
        title: Elegant Wooden Gloves
        price: 407
        description: New range of formal shirts are designed keeping you in mind.
        code: a111
        status: true
        stock: 3
        thumbnail: ["https://some-url.com", "https://some-url2.com"]
        category: Furniture
        owner: admin
    Ticket:
      type: object
      properties:
        _id:
          type: ObjectId
          description: Mongodb autogenerated id
        code:
          type: String
          description: Code of ticket
        amount:
          type: Number
          description: Total purchase
        purcharser:
          type: String
          description: User email
        copurchase_datetimede:
          type: Date
          description: Date of purchase
      example:
        _id: 647fd84630cde2bfca738e4a
        code: s1arGHqDHCF4LOANMymE
        amount: 498
        purchaser: gabyreload@gmail.com
        purchase_datetime: 2023-06-07T01:07:18.521Z
  requestBodies:
    updateCart:
      type: object
      properties:
        products:
          type: Array
          description: Array of products
          items:
            type: object
            properties:
              product:
                type: ObjectId
                $ref: "#components/schemas/Product"
              quantity:
                type: Number
                description: Product quantity
      example:
        products:
          [
            { "product": "640e80b4d756fc7ec87f2545", "quantity": 5 },
            { "product": "640e80b4d756fc7ec87f2544", "quantity": 4 },
          ]
    updateQuantity:
      type: object
      properties:
        quantity:
          type: Number
          description: Product Quantity
      example:
        quantity: 10
  responseBodies:
    addProductNotFoundCart:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Cart not found
    addProductNotFoundProduct:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Product not found
    updateQuantityIncompleteValues:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Incomplete values
    updateQuantityInvalidId:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Invalid id
    updateQuantityCartNotFound:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Cart not found
    updateQuantityProductNotFound:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Product not found
    deleteProductCartNotFound:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Cart not found
    deleteProductProductNotFound:
      type: object
      properties:
        status:
          type: String
          description: Request status
        message:
          type: String
          description: Error message
      example:
        status: error
        message: Product not found
